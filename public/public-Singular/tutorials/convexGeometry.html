Singular online<html>
  <head>
    <title>Tutorial: convex and tropical geometry</title>
  </head>
<body>

<div>
  <h4>Basic convex geometry via Gfanlib</h4>

  <p>Thanks to the integration of Gfanlib, Singular is able to handle basic convex geometry.</p>
  <code>LIB "gfanlib.so";</code><br>

  <p>For example, given a polynomial $f\in \QQ[x_1,\ldots,x_n]$, the Newton polytope $\Delta(f)$ is defined to be the convex hull of all its exponent vectors. Consider for example</p>

  <code>LIB "random.lib";</code><br>
  <code>ring R;</code><br>
  <code>poly f = sparsepoly(5);</code><br>

  <p>We have created a random homogeneous polynomial of degree $5$ in Singular's default ring, which is $\mathbb{F}_{32003}[x,y,z]$. In order to construct its Newton Polytope, we need to cycle through all monomials of $f$ and write down their exponent vectors, for example in an integer matrix $M$ in which each row corresponds to a monomial of $f$.</p>

  <code>intmat M[size(f)][3];</code><br>
  <code>for (int i=1; i<=size(f); i++)</code><br>
  <code>{</code><br>
  <code>  M[i,1..3] = leadexp(f[i]);</code><br>
  <code>}</code><br>
  <code>print(M);</code><br>

  <p>For $\Delta(f)$, we construct a polyhedral cone $\delta\subseteq\mathbb{R}^4$ such that
    $$ \delta \cup \{((x_0,\ldots,x_3)\in\mathbb{R}^4\mid x_0=1\} = \Delta(f). $$
    This is a classical way to represent polyhedras as cones via projective coordinates, so that points on $\{x_0=0\}$ are lying at infinity making the polyhedron unbounded.</p>

  <code>intmat N[size(f)][4];</code><br>
  <code>for (int i=1; i<=size(f); i++)</code><br>
  <code>{</code><br>
  <code>  N[i,2..4] = M[i,1..3];</code><br>
  <code>}</code><br>
  <code>print(N);</code><br>
  <code>cone delta = coneViaPoints(N);</code><br>

  <p> Note that because $f$ was homogeneous of degree $5$, $\delta$ lies in the hyperplane $\{x_1+x_2+x_3=5\}$, or $\{x_1+x_2+x_3-5x_0=0\}$ in projective coordinates.</p>

  <code>intmat ineq[1][4]; intmat eq[1][4]=-5,1,1,1;</code><br>
  <code>cone H = coneViaInequalities(ineq, eq);</code><br>
  <code>cone theta = convexIntersection(H,delta);</code><br>
  <code>theta == delta;</code><br>
</div>

<div>
  <h4>Advanced convex geometry via Polymake</h4>

  <p>Thanks to an interface to Polymake, more advanced methods of convex geometry are made available to Singular. Note that certain features of Polymake rely on further third party software.</p>
  <code>LIB "polymake.so";</code><br>

  <p>For a full list of features of polymake, please consult the official website. A full list of Polymake functions available inside Singular can be found in the manual.</p>

  <h5>Toric geometry</h5>

  <p>Polymake has...</p>

  <h5>Tropical intersection theory</h5>
  <p>Polymake has...</p>
</div>

<div>
  <h4>Tropical geometry</h4>

  <p>Singular also has native features for tropical geometry, which rely on the aforementioned software packages for convex geometry. For sake of comfort, they are inbuild in the interface to Gfanlib, which is a prerequisite for using convex geometry inside Singular.</p>
  <code>LIB "gfanlib.so";</code><br>

  <p>Consider for example the linear ideal
  $$I:=\langle x+2y-3z,3y-4z+5w\rangle\unlhd\QQ[x,y,z,w].$$</p>
  <code>ring r = 0,(w,x,y,z),dp;</code><br>
  <code>ideal I = x+2y-3z,3y-4z+5w;</code><br>

  <p>Its tropical variety under the trivial valuation, a.k.a. in the constant coefficient case, consists combinatorically of $4$ rays whose primitive generators obviously add up to $0$. However, because our ideal is homogeneous, our tropical variety naturally has a lineality space generated by $(1,1,1,1)$, making the minimal cones $2$-dimensional.</p>

  <p>fan T0 = tropicalVariety(I); T0;</p>

  <p>For low $p$-adic valuations, namely $p=2$ and $p=3$, the tropical variety has a slightly more complex polyhedral structure. Instead of four combinatorial rays, it has four unbounded polyhedra and one bounded edge. Unsurprisingly, the trivial valuation case yields the recession fan of the non-trivial valuation cases.</p>

  <p>fan T2 = tropicalVariety(I,number(2)); T2;</p>
  <p>fan T3 = tropicalVariety(I,number(3)); T3;</p>

  <p>For the $5$-adic valuation, the tropical variety has the same combinatorial structure as in the trivial valuation case. However the apex of the four rays is not the origin so it is no polyhedral fan.</p>

  <p>fan T5 = tropicalVariety(I,number(5)); T5;</p>

  <p>For high $p$-adic valuation, $p>5$, the tropical variety coincides with that in the trivial valuation case.</p>

  <p>fan T7 = tropicalVariety(I,number(7)); T7;</p>
  <p>fan T11 = tropicalVariety(I,number(11)); T11;</p>
</div>

</body>
</html>
